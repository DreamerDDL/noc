[
    {
        "name": "EdgeCore | ES | Network | LBD | Loop Detected (SYSLOG)",
        "description": "Sep 2 16:40:59 test snmp LBD detects loopback on port 8, VLAN 1.",
        "event_class__name": "Network | LBD | Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^EdgeCore\\.ES$"
            },
            {
                "key_re": "^message$",
                "value_re": "LBD detects loopback on port (?P<port>\\d+), VLAN (?P<vlan>\\d+)\\.$"
            }
        ],
        "vars": [
           {
                "name": "interface",
                "value": "='Eth 1/%s' % port"
           }
        ]
    },

    {
        "name": "EdgeCore | ES | Network | LBD | Loop Cleared (SYSLOG)",
        "description": "Sep 2 16:41:51 test snmp LBD recovers port 8.",
        "event_class__name": "Network | LBD | Loop Cleared",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^EdgeCore\\.ES$"
            },
            {
                "key_re": "^message$",
                "value_re": "LBD recovers port (?P<port>\\d+)\\.$"
            }
        ],
        "vars": [
           {
                "name": "interface",
                "value": "='Eth 1/%s' % port"
           }
        ]
    },
    {
        "name": "EdgeCore | ES | Network | LBD | Loop Detected (SNMP)",
        "description": "ES3528MO-MIB::lbdDetectionTrap",
        "event_class__name": "Network | LBD | Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^EdgeCore\\.ES$"
            },
            {
                "key_re": "^ES3528MO-MIB::trapIfIndex\\.0$",
                "value_re": "^(?P<interface__ifindex>\\d+)$"
            },
            {
                "key_re": "^ES3528MO-MIB::trapVlanId\\.0$",
                "value_re": "^(?P<vlan>\\d+)$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^ES3528MO-MIB::lbdDetectionTrap$"
            }

        ]
    },
    {
        "name": "EdgeCore | ES | Network | LBD | Loop Cleared (SNMP)",
        "description": "ES3528MO-MIB::lbdRecoveryTrap",
        "event_class__name": "Network | LBD | Loop Cleared",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^EdgeCore\\.ES$"
            },
            {
                "key_re": "^ES3528MO-MIB::trapIfIndex\\.0$",
                "value_re": "^(?P<interface__ifindex>\\d+)$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^ES3528MO-MIB::lbdRecoveryTrap$"
            }

        ]
    }
]
