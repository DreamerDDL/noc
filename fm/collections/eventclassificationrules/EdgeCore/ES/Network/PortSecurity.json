[
    {
        "name": "EdgeCore | ES | Network | Port Security | Port Security Violation (SYSLOG)",
        "description": "Sep 19 16:56:41 Rybatsk-17-1 snmp Unit 1 port 13 have intrusion MAC 001517-8FBD5B.",
        "event_class__name": "Network | Port Security | Port Security Violation",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^EdgeCore\\.ES$"
            },
            {
                "key_re": "^message$",
                "value_re": "Unit (?P<unit>\\S+) port\\s+(?P<port>\\d+) have intrusion MAC (?P<mac>\\S+)\\.$"
            }
        ],
        "vars": [
            {
                "name": "interface",
                "value": "='Eth %s/%s' % (unit, port)"
            }
        ]
    },

    {
        "name": "EdgeCore | ES | Network | Port Security | Port Security Violation #1 (SYSLOG)",
        "description": "Sep 20 17:12:33 172.16.3.100 snmp Unit 1, Port 1 have intrusion mac address.",
        "event_class__name": "Network | Port Security | Port Security Violation",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^EdgeCore\\.ES$"
            },
            {
                "key_re": "^message$",
                "value_re": "Unit (?P<unit>\\S+), Port\\s+(?P<port>\\d+) have intrusion mac address\\.$"
            }
        ],
        "vars": [
            {
                "name": "interface",
                "value": "='Eth %s/%s' % (unit, port)"
            }
        ]
    },

    {
        "name": "EdgeCore | ES | Network | Port Security | Port Security Violation (SNMP)",
        "description": "ES3528MO-MIB::swPortSecurityTrap",
        "event_class__name": "Network | Port Security | Port Security Violation",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^EdgeCore\\.ES$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^ES3528MO-MIB::swPortSecurityTrap$"
            },
            {
                "key_re": "^IF-MIB::ifIndex\\.\\d+$",
                "value_re": "^(?P<interface__ifindex>\\d+)$"
            },
            {
                "key_re": "^ES3528MO-MIB::trapPortSecurityIntrusionMac\\.0$",
                "value_re": "^(?P<mac__bin_to_mac>.+)$"
            }
        ]
    },

    {
        "name": "EdgeCore | ES | Network | Port Security | Port Security Violation #1 (SNMP)",
        "description": "ES3528MO-MIB::swPortSecurityTrap",
        "event_class__name": "Network | Port Security | Port Security Violation",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^EdgeCore\\.ES$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "^ES3528MO-MIB::swPortSecurityTrap$"
            },
            {
                "key_re": "^IF-MIB::ifIndex\\.\\d+$",
                "value_re": "^(?P<interface__ifindex>\\d+)$"
            }
        ]
    }
]
