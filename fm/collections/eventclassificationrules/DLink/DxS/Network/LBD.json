[
    {
        "name": "DLink | DxS | Network | LBD | Loop Detected #1 (SYSLOG)",
        "description": "WARN: Configuration Testing Protocol detects a loop in port 4",
        "event_class__name": "Network | LBD | Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:WARN:|WARN\\(4\\)|INFO:) Configuration Testing Protocol detects a loop in port (?P<interface>\\S+)"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | LBD | Loop Cleared #1 (SYSLOG)",
        "description": "INFO: Port 11 LBD port recovered. Loop detection restarted",
        "event_class__name": "Network | LBD | Loop Cleared",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:INFO:|INFO\\(6\\)) Port (?P<interface>.+) LBD port recovered. Loop detection restarted"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | LBD | Loop Detected #2 (SYSLOG)",
        "description": "CRIT: Port 4 LBD loop occurred. Port blocked",
        "event_class__name": "Network | LBD | Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:CRIT:|CRIT\\(2\\)) Port (?P<interface>.+) LBD loop occurred. Port blocked"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | LBD | Vlan Loop Detected (SYSLOG)",
        "description": "CRIT(2) Port 25 VID 356 LBD loop occurred. Packet discard begun",
        "event_class__name": "Network | LBD | Vlan Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:CRIT:|CRIT\\(2\\)) Port (?P<interface>.+) VID (?P<vlan>\\d+) LBD loop occurred. Packet discard begun"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | LBD | Vlan Loop Cleared (SYSLOG)",
        "description": "INFO(6) Port 25 VID 356 LBD recovered. Loop detection restarted",
        "event_class__name": "Network | LBD | Vlan Loop Cleared",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(?:INFO:|INFO\\(6\\)) Port (?P<interface>.+) VID (?P<vlan>\\d+) LBD recovered. Loop detection restarted"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | LBD | Vlan Loop Detected (SNMP)",
        "description": "LOOPBACK-DETECT-MIB::swVlanLoopOccurred",
        "event_class__name": "Network | LBD | Vlan Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "LOOPBACK-DETECT-MIB::swVlanLoopOccurred"
            },
            {
                "key_re": "^LOOPBACK-DETECT-MIB::swLoopDetectPortIndex$",
                "value_re": "^(?P<interface>\\S+)$"
            },
            {
                "key_re": "^LOOPBACK-DETECT-MIB::swVlanLoopDetectVID$",
                "value_re": "^(?P<vlan>\\S+)$"
            }
        ]
    },

    {
        "name": "DLink | DxS | Network | LBD | Vlan Loop Cleared (SNMP)",
        "description": "LOOPBACK-DETECT-MIB::swVlanLoopOccurred",
        "event_class__name": "Network | LBD | Vlan Loop Cleared",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^SNMP Trap$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^SNMPv2-MIB::snmpTrapOID\\.0$",
                "value_re": "LOOPBACK-DETECT-MIB::swVlanLoopRestart"
            },
            {
                "key_re": "^LOOPBACK-DETECT-MIB::swLoopDetectPortIndex$",
                "value_re": "^(?P<interface>\\S+)$"
            },
            {
                "key_re": "^LOOPBACK-DETECT-MIB::swVlanLoopDetectVID$",
                "value_re": "^(?P<vlan>\\S+)$"
            }
        ]
    }
]
