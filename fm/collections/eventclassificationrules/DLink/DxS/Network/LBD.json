[
    {
        "name": "DLink | DxS | Network | LBD | Loop Detected #1 (SYSLOG)",
        "description": "WARN: Configuration Testing Protocol detects a loop in port 4",
        "event_class__name": "Network | LBD | Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(WARN:|WARN\\(4\\)|INFO:) Configuration Testing Protocol detects a loop in port (?P<interface>.+)$"
            }
        ]
    },
    
    {
        "name": "DLink | DxS | Network | LBD | Loop Cleared #1 (SYSLOG)",
        "description": "INFO: Port 11 LBD port recovered. Loop detection restarted",
        "event_class__name": "Network | LBD | Loop Cleared",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(INFO:|INFO\\(6\\)) Port (?P<interface>.+) LBD port recovered. Loop detection restarted$"
            }
        ]
    },
    
    {
        "name": "DLink | DxS | Network | LBD | Loop Detected #2 (SYSLOG)",
        "description": "CRIT: Port 4 LBD loop occurred. Port blocked",
        "event_class__name": "Network | LBD | Loop Detected",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^DLink\\.DxS$"
            },
            {
                "key_re": "^message$",
                "value_re": "(CRIT:|CRIT\\(2\\)) Port (?P<interface>.+) LBD loop occurred. Port blocked$"
            }
        ]
    }
]