[
    {
        "name": "Huawei | VRP | Network | STP | Topology Changed MSTP #1 (SYSLOG)",
        "description": "Jul 19 2012 18:11:46 kie-bro-smp-r3-t4-asw0 %%01MSTP/6/RECEIVE_MSTITC(l)[1011]:MSTP received BPDU with TC, MSTP process 0 instance 5, port name is GigabitEthernet0/0/2.",
        "event_class__name": "Network | STP | Topology Changed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Huawei\\.VRP$"
            },
            {
                "key_re": "^message$",
                "value_re": "RECEIVE_(?:MSTITC|CISTTC).+instance (?P<instance>\\d+), port name is (?P<interface>.+)."
            }
        ]
    },

    {
        "name": "Huawei | VRP | Network | STP | STP Port State Changed MSTP #1 (SYSLOG)",
        "description": "Jul 19 2012 18:12:13 kie-bro-smp-r3-t4-asw0 %%01MSTP/6/SET_PORT_FORWARDING(l)[1015]:In MSTP process 0 instance 0,MSTP set port GigabitEthernet0/0/1 state as forwarding.",
        "event_class__name": "Network | STP | STP Port State Changed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Huawei\\.VRP$"
            },
            {
                "key_re": "^message$",
                "value_re": "MSTP/\\d+/SET_PORT_\\w+.+process \\d+ instance \\d+,\\s*MSTP set port (?P<interface>\\S+) state as (?P<state__enum__stp_state>\\S+)\\.$"
            }
        ]
    },

    {
        "name": "Huawei | VRP | Network | STP | STP Port State Changed MSTP #2 (SYSLOG)",
        "description": "Jul 19 2012 18:12:13 kie-bro-smp-r3-t4-asw0 MSTP/4/PFWD:OID 1.3.6.1.4.1.2011.5.25.42.4.2.1 The port has been set to forwarding state. (InstanceID=5, PortInstanceID=5, PortID=24, IfIndex=30, PortName=GigabitEthernet0/0/1)",
        "event_class__name": "Network | STP | STP Port State Changed",
        "preference": 1000,
        "patterns": [
            {
                "key_re": "^source$",
                "value_re": "^syslog$"
            },
            {
                "key_re": "^profile$",
                "value_re": "^Huawei\\.VRP$"
            },
            {
                "key_re": "^message$",
                "value_re": "port has been set to (?P<state__enum__stp_state>\\S+) state.+InstanceID=(?P<instance>\\S+),.+PortName=(?P<interface>\\S+)\\)$"
            }
        ]
    }
]
