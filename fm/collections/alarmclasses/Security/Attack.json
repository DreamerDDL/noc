[
    {
        "name": "Security | Attack | Attack",
        "description": "Attack in progress detected",
        "is_unique": true,
        "discriminator": [ ],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            },
            {
                "name": "VCDS",
                "datasource": "vc.VCDS",
                "search": {
                    "managed_object": "managed_object",
                    "l1": "vlan"
                }
            }
        ],
        "vars": [
            {
                "name": "name",
                "description": "Attack name",
                "type": "str",
                "required": true
            },
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "src_ip",
                "description": "Source IP",
                "type": "ip_address",
                "required": false
            },
            {
                "name": "src_mac",
                "description": "Source MAC",
                "type": "mac",
                "required": false
            },
            {
                "name": "vlan",
                "description": "Vlan ID",
                "type": "int",
                "required": false
            }
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            },
            {
                "name": "vlan_name",
                "description": "Vlan name",
                "type": "str",
                "required": false,
                "default": "=VCDS.name"
            }
        ],
        "text": {
            "en": {
                "subject_template": "{{name}} attack detected{% if interface %} at interface {{interface}}{% endif %}{% if description %} ({{description}}){% endif %}{% if src_ip %} from {{src_ip}}{% endif %}",
                "body_template": "{{name}} attack detected.{% if interface %}\nInterface: {{interface}}{% endif %}{% if description %} ({{description}}){% endif %}{% if src_ip %}\nSource IP: {{src_ip}}{% endif %}{% if src_mac %}\nSource MAC: {{src_mac}}{% endif %}{% if vlan %}\nVlan: {{vlan}}{% endif %}{% if vlan_name %} ({{vlan_name}}){% endif %}",
                "symptoms": "Unsolicitized traffic from source",
                "probable_causes": "Virus/Botnet activity or malicious actions",
                "recommended_actions": "Negotiate the source if it is your customer, or ignore"
            }
        }
    },

    {
        "name": "Security | Attack | Blat Attack",
        "description": "Blat Attack Detected",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "src_ip",
                "description": "Source IP",
                "type": "ip_address",
                "required": false
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "Blat Attack detected on {{interface}}{% if description %} ({{description}}){% endif %}{% if src_ip %}: {{src_ip}}{% endif %}",
                "body_template": "Blat Attack detected on {{interface}}{% if description %} ({{description}}){% endif %}{% if src_ip %}: {{src_ip}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },

    {
        "name": "Security | Attack | Land Attack",
        "description": "Land Attack Detected",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "src_ip",
                "description": "Source IP",
                "type": "ip_address",
                "required": false
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "Land Attack detected on {{interface}}{% if description %} ({{description}}){% endif %}{% if src_ip %}: {{src_ip}}{% endif %}",
                "body_template": "Land Attack detected on {{interface}}{% if description %} ({{description}}){% endif %}{% if src_ip %}: {{src_ip}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },

    {
        "name": "Security | Attack | Smurf Attack",
        "description": "Smurf Attack Detected",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "src_ip",
                "description": "Source IP",
                "type": "ip_address",
                "required": false
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "Smurf Attack detected on {{interface}}{% if description %} ({{description}}){% endif %}{% if src_ip %}: {{src_ip}}{% endif %}",
                "body_template": "Smurf Attack detected on {{interface}}{% if description %} ({{description}}){% endif %}{% if src_ip %}: {{src_ip}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },

    {
        "name": "Security | Attack | TCP SYNFIN Scan",
        "description": "TCP SYNFIN Scan",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "src_ip",
                "description": "Source IP",
                "type": "ip_address",
                "required": false
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "TCP SYNFIN Scan detected on {{interface}}{% if description %} ({{description}}){% endif %}{% if src_ip %}: {{src_ip}}{% endif %}",
                "body_template": "TCP SYNFIN Scan detected on {{interface}}{% if description %} ({{description}}){% endif %}{% if src_ip %}: {{src_ip}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },

    {
        "name": "Security | Attack | IP Spoofing",
        "description": "IP Spoofing detected",
        "is_unique": true,
        "discriminator": ["src_ip", "interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "src_ip",
                "description": "Source IP",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "src_mac",
                "description": "Source MAC",
                "type": "mac",
                "required": false
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "IP Spoofing detected on {{interface}}{% if description %} ({{description}}){% endif %}, IP:{{src_ip}}{% if src_mac %}, MAC:{{src_mac}}{% endif %}",
                "body_template": "IP Spoofing detected on {{interface}}{% if description %} ({{description}}){% endif %}, IP:{{src_ip}}{% if src_mac %}, MAC:{{src_mac}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": "" 
            }
        }
    },

    {
        "name": "Security | Attack | Ping Of Death",
        "description": "Ping Of Death detected",
        "is_unique": true,
        "discriminator": ["src_ip", "interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "src_ip",
                "description": "Source IP",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "src_mac",
                "description": "Source MAC",
                "type": "mac",
                "required": false
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "Ping Of Death detected on {{interface}}{% if description %} ({{description}}){% endif %}, IP:{{src_ip}}{% if src_mac %}, MAC:{{src_mac}}{% endif %}",
                "body_template": "Ping Of Death detected on {{interface}}{% if description %} ({{description}}){% endif %}, IP:{{src_ip}}{% if src_mac %}, MAC:{{src_mac}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": "" 
            }
        }
    },

    {
        "name": "Security | Attack | Teardrop Attack",
        "description": "Teardrop attack detected",
        "is_unique": true,
        "discriminator": ["src_ip", "interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "src_ip",
                "description": "Source IP",
                "type": "ip_address",
                "required": true
            },
            {
                "name": "src_mac",
                "description": "Source MAC",
                "type": "mac",
                "required": false
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "Teardrop attack detected on {{interface}}{% if description %} ({{description}}){% endif %}, IP:{{src_ip}}{% if src_mac %}, MAC:{{src_mac}}{% endif %}",
                "body_template": "Teardrop attack detected on {{interface}}{% if description %} ({{description}}){% endif %}, IP:{{src_ip}}{% if src_mac %}, MAC:{{src_mac}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": "" 
            }
        }
    }
]
