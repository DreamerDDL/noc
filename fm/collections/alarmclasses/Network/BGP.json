[
    {
        "name": "Network | BGP | Peer Down",
        "description": "A",
        "is_unique": true,
        "discriminator": ["peer"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "enrichment_pyrule__name": "ae_network_bgp_peer_down",
        "vars": [
            {
                "name": "peer",
                "description": "BGP Peer",
                "type": "ip_address",
                "required": true
            },
            
            {
                "name": "as",
                "description": "BGP Peer AS",
                "type": "int",
                "required": false
            }
        ],
        "text": {
            "en": {
                "subject_template": "BGP Peer {{peer}}{% if as %}(AS{{as}}{% if alarm.data and alarm.data.description %}, {{alarm.data.description}}{% endif %}){% else %}{% if alarm.data %}(AS{{alarm.data.remote_as}}, {{alarm.data.description}}){%endif%}{% endif %} session down",
                "body_template": "BGP Peer {{peer}}{% if as %}(AS{{as}}){% endif %} session down{% if alarm.data %}\nLocal AS: {{alarm.data.local_as}}\nRemote AS:{{alarm.data.remote_as}}\nDescription: {{alarm.data.description}}\nLink: {{alarm.data.local_ip}} -- {{alarm.data.remote_ip}}\nImport Filter: {{alarm.data.import_filter}}\nExport Filter: {{alarm.data.export_filter}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },
    
    {
        "name": "Network | BGP | Prefix Limit Exceeded",
        "description": "A",
        "is_unique": true,
        "discriminator": ["peer"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "vars": [
            {
                "name": "peer",
                "description": "BGP Peer",
                "type": "ip_address",
                "required": true
            },
            
            {
                "name": "as",
                "description": "BGP Peer AS",
                "type": "int",
                "required": false
            }
        ],
        "text": {
            "en": {
                "subject_template": "BGP Peer {{peer}}{% if as %}(AS{{as}}){% endif %} prefix limit exceeded",
                "body_template": "BGP Peer {{peer}}(AS{{as}}) prefix limit exceeded",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    }
]
