[
    {
        "name": "Network | MAC | MAC Flap",
        "description": "Flapping MAC Detected",
        "is_unique": true,
        "discriminator": ["mac"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "fromInterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "from_interface"
                }
            },
            {
                "name": "toInterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "to_interface"
                }
            },
            {
                "name": "VCDS",
                "datasource": "vc.VCDS",
                "search": {
                    "managed_object": "managed_object",
                    "l1": "vlan"
                }
            }
        ],
        "vars": [
            {
                "name": "mac",
                "description": "MAC Address",
                "type": "mac",
                "required": true
            },
            {
                "name": "vlan",
                "description": "VLAN",
                "type": "int",
                "required": true
            },
            {
                "name": "from_interface",
                "description": "From interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "to_interface",
                "description": "To interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "from_description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=fromInterfaceDS.description"
            },
            {
                "name": "to_description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=toInterfaceDS.description"
            },
            {
                "name": "vlan_name",
                "description": "Vlan name",
                "type": "str",
                "required": false,
                "default": "=VCDS.name"
            },
            {
                "name": "vlan_description",
                "description": "Vlan description",
                "type": "str",
                "required": false,
                "default": "=VCDS.description"
            },
            {
                "name": "vlan_vc_domain",
                "description": "VC domain",
                "type": "str",
                "required": false,
                "default": "=VCDS.vc_domain"
            }
        ],
        "text": {
            "en": {
                "subject_template": "MAC {{mac}} Flap detected on vlan {{vlan}}{% if vlan_name %} ({{vlan_name}}){% endif %}: {{from_interface}}{% if from_description %} ({{from_description}}){% endif %} -> {{to_interface}}{% if to_description %} ({{to_description}}){% endif %}",
                "body_template": "MAC {{mac}} Flap detected on vlan {{vlan}}{% if vlan_name %} ({{vlan_name}}){% endif %}: {{from_interface}}{% if from_description %} ({{from_description}}){% endif %} -> {{to_interface}}{% if to_description %} ({{to_description}}){% endif %}{% if vlan_vc_domain %}\nVC Domain: {{vlan_vc_domain}}{% endif %}{% if vlan_description %}\nVLAN Description: {{vlan_description}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },

    {
        "name": "Network | MAC | Duplicate MAC",
        "description": "Duplicate MAC Detected",
        "is_unique": true,
        "discriminator": ["mac"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "vars": [
            {
                "name": "mac",
                "description": "MAC Address",
                "type": "mac",
                "required": true
            },
            {
                "name": "one_interface",
                "description": "First interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "two_interface",
                "description": "Second interface",
                "type": "interface_name",
                "required": true
            }
        ],
        "text": {
            "en": {
                "subject_template": "Duplicate MAC {{mac}} detected on interfaces {{one_interface}} and {{two_interface}}",
                "body_template": "Duplicate MAC {{mac}} detected on interfaces {{one_interface}} and {{two_interface}}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },

    {
        "name": "Network | MAC | Invalid MAC",
        "description": "Invalid MAC Detected",
        "is_unique": true,
        "discriminator": ["mac"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "vars": [
            {
                "name": "mac",
                "description": "MAC Address",
                "type": "mac",
                "required": true
            },
            {
                "name": "interface",
                "description": "Affected interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "vlan",
                "description": "Affected vlan",
                "type": "int",
                "required": false
            }
        ],
        "text": {
            "en": {
                "subject_template": "Invalid MAC {{mac}} detected on interfaces {{interface}}{% if vlan %}, vlan {{vlan}}{% endif %}",
                "body_template": "Invalid MAC {{mac}} detected on interfaces {{interface}}{% if vlan %}, vlan {{vlan}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    },

    {
        "name": "Network | MAC | MAC Flood",
        "description": "Flooding MAC Detected",
        "is_unique": true,
        "discriminator": ["mac"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "vars": [
            {
                "name": "mac",
                "description": "MAC Address",
                "type": "mac",
                "required": true
            },
            {
                "name": "vlan",
                "description": "VLAN",
                "type": "int",
                "required": true
            },
            {
                "name": "interface",
                "description": "Interface",
                "type": "interface_name",
                "required": false
            }
        ],
        "text": {
            "en": {
                "subject_template": "The flooding MAC is detected on vlan {{vlan}}, MAC {{mac}}{% if interface %}, interface {{interface}}{% endif %}",
                "body_template": "The flooding MAC is detected on vlan {{vlan}}, MAC {{mac}}{% if interface %}, interface {{interface}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": ""
            }
        }
    }
]
