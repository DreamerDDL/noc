[
    {
        "name": "Network | STP | BPDU Guard Violation",
        "description": "BPDU Guard Violation",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "BPDU Guard Violation on {{interface}}{% if description %} ({{description}}){% endif %}",
                "body_template": "BPDU Guard Violation on {{interface}}{% if description %} ({{description}}){% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": "" 
            }
        }
    },

    {
        "name": "Network | STP | Root Guard Violation",
        "description": "Root Guard Violation",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "MAJOR",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "STP Root Guard Violation on {{interface}}{% if description %} ({{description}}){% endif %}",
                "body_template": "STP Root Guard Violation on {{interface}}{% if description %} ({{description}}){% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": "" 
            }
        }
    },

    {
        "name": "Network | STP | STP Loop Detected",
        "description": "STP Loop Detected",
        "is_unique": true,
        "discriminator": ["interface"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            }
        ],
        "text": {
            "en": {
                "subject_template": "STP Loop Detected on {{interface}}{% if description %} ({{description}}){% endif %}",
                "body_template": "STP Loop Detected on {{interface}}{% if description %} ({{description}}){% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": "" 
            }
        }
    },

    {
        "name": "Network | STP | STP Vlan Loop Detected",
        "description": "STP Vlan Loop Detected",
        "is_unique": true,
        "discriminator": ["interface", "vlan"],
        "user_clearable": true,
        "default_severity__name": "WARNING",
        "datasources": [
            {
                "name": "InterfaceDS",
                "datasource": "inv.InterfaceDS",
                "search": {
                    "managed_object": "managed_object",
                    "interface": "interface"
                }
            },
            {
                "name": "VCDS",
                "datasource": "vc.VCDS",
                "search": {
                    "managed_object": "managed_object",
                    "l1": "vlan"
                }
            }
        ],
        "vars": [
            {
                "name": "interface",
                "description": "interface",
                "type": "interface_name",
                "required": true
            },
            {
                "name": "vlan",
                "description": "vlan",
                "type": "int",
                "required": true
            },
            {
                "name": "description",
                "description": "Interface description",
                "type": "str",
                "required": false,
                "default": "=InterfaceDS.description"
            },
            {
                "name": "vlan_name",
                "description": "Vlan name",
                "type": "str",
                "required": false,
                "default": "=VCDS.name"
            },
            {
                "name": "vlan_description",
                "description": "Vlan description",
                "type": "str",
                "required": false,
                "default": "=VCDS.description"
            },
            {
                "name": "vlan_vc_domain",
                "description": "VC domain",
                "type": "str",
                "required": false,
                "default": "=VCDS.vc_domain"
            }
        ],
        "text": {
            "en": {
                "subject_template": "STP Vlan Loop Detected on {{interface}}{% if description %} ({{description}}){% endif %} vlan {{vlan}}{% if vlan_name %} ({{vlan_name}}){% endif %}",
                "body_template": "STP Vlan Loop Detected on {{interface}}{% if description %} ({{description}}){% endif %} vlan {{vlan}}{% if vlan_name %} ({{vlan_name}}){% endif %}{% if vlan_vc_domain %}\nVC Domain: {{vlan_vc_domain}}{% endif %}{% if vlan_description %}\nVLAN Description: {{vlan_description}}{% endif %}",
                "symptoms": "",
                "probable_causes": "",
                "recommended_actions": "" 
            }
        }
    }
]
