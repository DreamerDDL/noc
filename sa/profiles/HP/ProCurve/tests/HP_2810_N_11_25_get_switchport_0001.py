# -*- coding: utf-8 -*-
##----------------------------------------------------------------------
## HP.ProCurve.get_switchport test
## Auto-generated by ./noc debug-script at 21.01.2013 18:18:26
##----------------------------------------------------------------------
## Copyright (C) 2007-2013 The NOC Project
## See LICENSE for details
##----------------------------------------------------------------------

## NOC modules
from noc.lib.test import ScriptTestCase


class HP_ProCurve_get_switchport_Test(ScriptTestCase):
    script = "HP.ProCurve.get_switchport"
    vendor = "HP"
    platform = "2810"
    version = "N.11.25"
    input = {}
    result = u'<class \'noc.sa.script.exception.CLISyntaxError\'>\nerminal length 1000Invalid input: erminal\n\nSTART OF TRACEBACK\n------------------------------------------------------------------------\nFile: /opt/noc/sa/script/script.py (Line: 628)\nFunction: cli\n  621             if isinstance(data, Exception):\n  622                 # Exception captured\n  623                 raise data\n  624             if not ignore_errors:\n  625                 # Check for syntax error\n  626                 if (self.profile.rx_pattern_syntax_error and\n  627                     self.profile.rx_pattern_syntax_error.search(data)):\n  628 ==>                 raise self.CLISyntaxError(data)\n  629                 # Then check for operaion error\n  630                 if (self.profile.rx_pattern_operation_error and\n  631                     self.profile.rx_pattern_operation_error.search(data)):\n  632                     raise self.CLIOperationError(data)\n  633             # Echo cancelation\n  634             if self.strip_echo and data.lstrip().startswith(cmd):\nVariables:\n                 cmd = \'walkMIB dot1dBaseNumPorts\'\n                  cc = \'CLI:walkMIB dot1dBaseNumPorts\'\n          bulk_lines = None\n               cache = {}\n      command_submit = \'\\n\'\n              cached = False\n          from_cache = False\n                file = None\n             list_re = None\n       ignore_errors = False\n                data = \'erminal length 1000Invalid input: erminal\\n\'\n                self = <Script(script-192.168.2.12-HP.ProCurve.get_switchport, started 139896949831424)>\n------------------------------------------------------------------------\nFile: /opt/noc/sa/profiles/HP/ProCurve/get_switchport.py (Line: 62)\nFunction: execute\n   55                         if not i in tag.keys(): tag[i] = [] \n   56                         tag[i] += [j]           \n   57             return untag, tag\n   58             \n   59             \n   60             \n   61         def execute(self):\n   62 ==>         portsnum = int(self.cli("walkMIB dot1dBaseNumPorts").split(\'=\')[1])\n   63             untagged, tagged = self.getVlanPort()\n   64             iface = {}\n   65             sports = []\n   66             step = len(self.objstr)\n   67             lines = self.cli("walkMIB " + " ".join(self.objstr.keys())).split("\\n")[:-1]\n   68             portchannel_members = {}  # member -> (portchannel, type)\nVariables:\n                self = <Script(script-192.168.2.12-HP.ProCurve.get_switchport, started 139896949831424)>\n------------------------------------------------------------------------\nFile: /opt/noc/sa/script/script.py (Line: 417)\nFunction: guarded_run\n  410                     return result\n  411                 except KeyError:\n  412                     self.debug("Not in call cache: %r, %r" % (self.name,\n  413                                                               self.kwargs))\n  414                     pass\n  415                 # Calling script body\n  416             self._thread_id = thread.get_ident()\n  417 ==>         result = self.execute(**self.kwargs)\n  418             # Enforce interface result checking\n  419             for i in self.implements:\n  420                 result = i.script_clean_result(self.profile, result)\n  421             # Cache result when required\n  422             if self.cache and self.parent is not None:\n  423                 self.debug("Write to call cache: %s, %s, %r" % (self.name,\nVariables:\n                   i = <noc.sa.interfaces.igetswitchport.IGetSwitchport object at 0x3464250>\n                self = <Script(script-192.168.2.12-HP.ProCurve.get_switchport, started 139896949831424)>\n------------------------------------------------------------------------\nFile: /opt/noc/sa/script/script.py (Line: 440)\nFunction: run\n  433     \n  434         def run(self):\n  435             """Script thread worker method"""\n  436             self.debug("Running")\n  437             result = None\n  438             try:\n  439                 with self.cancelable():\n  440 ==>                 result = self.guarded_run()\n  441             except self.TimeOutError:\n  442                 self.error("Timed out")\n  443                 self.e_timeout = True\n  444             except CancelledError:\n  445                 self.error("Cancelled")\n  446                 self.e_cancel = True\nVariables:\n                self = <Script(script-192.168.2.12-HP.ProCurve.get_switchport, started 139896949831424)>\n                   r = ["<class \'noc.sa.script.exception.CLISyntaxError\'>", \'erminal length 1000Invalid input: erminal\\n\']\n              result = None\n                   v = CLISyntaxError(\'erminal length 1000Invalid input: erminal\\n\',)\n                  tb = <traceback object at 0x40ad320>\n                   t = <class \'noc.sa.script.exception.CLISyntaxError\'>\n------------------------------------------------------------------------\nEND OF TRACEBACK'
    motd = ''
    cli = {
'walkMIB dot1dBaseNumPorts':  'erminal length 1000Invalid input: erminal\n', 
## 'terminal length 1000'
'terminal length 1000': """ProCurve J9022A Switch 2810-48G
Software revision N.11.25

Copyright (C) 1991-2010 Hewlett-Packard Co.  All Rights Reserved.

                           RESTRICTED RIGHTS LEGEND

 Use, duplication, or disclosure by the Government is subject to restrictions
 as set forth in subdivision (b) (3) (ii) of the Rights in Technical Data and
 Computer Software clause at 52.227-7013.

         HEWLETT-PACKARD COMPANY, 3000 Hanover St., Palo Alto, CA 94303
""", 
}
    snmp_get = {}
    snmp_getnext = {}
    http_get = {}
